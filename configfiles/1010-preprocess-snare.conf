# SOF-ELKÂ® Configuration File
# (C)2024 Lewes Technology Consulting, LLC
#
# This file contains preprocessing steps for Windows Event Log messages sent via the Snare utility

filter {
  if [type] == "syslog" and [message] =~ /^MSWinEventLog/ {
    mutate {
      gsub => [
        # delete the first field, as it's static and no longer needed
        "message", "MSWinEventLog#011", "",
        # protect quotes since we use the csv processor downstream
        "message", "\"", "'",
        # replace hex-encoded tabs and carriage returns and literal tabs with double-pipe for CSV handling later
        "message", "(?:#011)+", "||",
        "message", "\t+", "||",
        "message", "#015$", ""
      ]
      add_tag => [ "snare_log" ]
    }
  }
}
