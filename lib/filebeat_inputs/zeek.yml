# SOF-ELK® Configuration File
# (C)2023 Lewes Technology Consulting, LLC
#
# This file creates filebeats prospector for Zeek source data from the SOF-ELK® VM itself

- type: filestream
  id: zeek-conn-01
  paths:
    - /logstash/zeek/**/conn.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_conn
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-dhcp-01
  paths:
    - /logstash/zeek/**/dhcp.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_dhcp
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-dns-01
  paths:
    - /logstash/zeek/**/dns.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_dns
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-dpd-01
  paths:
    - /logstash/zeek/**/dpd.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_dpd
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-files-01
  paths:
    - /logstash/zeek/**/files.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_files
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-ftp-01
  paths:
    - /logstash/zeek/**/ftp.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_ftp
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-http-01
  paths:
    - /logstash/zeek/**/http.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_http
  tags: [ 'zeek' ]

- type: filestream
  id: zeek-irc-01
  paths:
    - /logstash/zeek/**/irc.*
  close.on_state_change.inactive: 5m
  clean_removed: true
  fields_under_root: true
  fields:
    type: zeek_irc
  tags: [ 'zeek' ]
