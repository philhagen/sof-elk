# SOF-ELK® Configuration File
# (C)2023 Lewes Technology Consulting, LLC
#
# This file creates a filebeat prospector for Office 365 source data from the SOF-ELK® VM itself

- type: filestream
  id: microsoft365-json
  paths:
    - /logstash/microsoft365/**/*.json
  close.on_state_change.inactive: 5m
  exclude_lines: ['^\[$']
  parsers:
  - multiline:
      pattern: '^{'
      negate: true
      match: after
      max_lines: 10000000
      flush_pattern: '^}'
  clean_removed: true
  fields_under_root: true
  fields:
    type: microsoft365
  tags: [ 'json' ]
